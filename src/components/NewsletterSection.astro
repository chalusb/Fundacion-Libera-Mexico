---
export interface Props {
  backgroundColor?: string;
  titleColor?: string;
  textColor?: string;
  buttonColor?: string;
}

const {
  backgroundColor = "bg-gray-50",
  titleColor = "text-gray-900",
  textColor = "text-gray-700",
  buttonColor = "bg-foundation-primary hover:bg-foundation-primary/90",
} = Astro.props;
---

<section class={`${backgroundColor} py-20 px-4 sm:px-6 lg:px-8`}>
  <div class="max-w-4xl mx-auto text-center">
    <!-- Section title -->
    <div class="mb-12">
      <h2 class={`${titleColor} text-3xl sm:text-4xl font-bold mb-6`}>
        Mantente Informado
      </h2>
      <p class={`${textColor} text-lg leading-relaxed max-w-2xl mx-auto`}>
        Suscríbete y recibe cada mes avances, información útil y noticias que te
        ayudarán a comprender esta problemática y sumar a la construcción de un
        futuro más justo.
      </p>
    </div>

    <!-- Newsletter form -->
    <div class="max-w-lg mx-auto">
      <form class="flex items-center gap-4" id="newsletter-section-form">
        <div>
          <input
            type="email"
            placeholder="Tu correo electrónico"
            required
            class="px-6 py-4 min-w-96 bg-white border border-gray-300 rounded-lg text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-foundation-primary focus:border-transparent transition-colors duration-200 shadow-sm"
          />
        </div>
        <button
          type="submit"
          class={`${buttonColor} text-white font-bold py-4 px-8 rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-foundation-primary focus:ring-offset-2 focus:ring-offset-gray-50 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-200`}
        >
          SUSCRÍBETE
        </button>
      </form>

      <!-- Additional info -->
      <p class={`${textColor} text-sm mt-4`}>Cancela cuando quieras.</p>
    </div>
  </div>
</section>

<script>
  // Manejar el formulario de newsletter
  document.addEventListener("DOMContentLoaded", () => {
    const newsletterForm = document.getElementById("newsletter-section-form");

    if (newsletterForm) {
      newsletterForm.addEventListener("submit", (e) => {
        e.preventDefault();

        const emailInput = newsletterForm.querySelector(
          'input[type="email"]'
        ) as HTMLInputElement;
        const submitButton = newsletterForm.querySelector(
          'button[type="submit"]'
        ) as HTMLButtonElement;

        if (!emailInput || !submitButton) {
          console.error("No se encontraron los elementos del formulario");
          return;
        }

        const email = emailInput.value.trim();

        if (!email) {
          alert("Por favor, ingresa tu correo electrónico");
          return;
        }

        // Validar formato de email
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
          alert("Por favor, ingresa un correo electrónico válido");
          return;
        }

        // Cambiar el texto del botón para mostrar que se está procesando
        const originalText = submitButton.textContent;
        submitButton.textContent = "Suscribiendo...";
        submitButton.disabled = true;

        // Simular envío (aquí conectarías con tu servicio de newsletter)
        setTimeout(() => {
          alert(
            "¡Gracias por suscribirte! Te mantendremos informado sobre nuestros avances."
          );
          emailInput.value = "";
          if (submitButton && originalText) {
            submitButton.textContent = originalText;
            submitButton.disabled = false;
          }
        }, 1500);
      });
    }
  });
</script>
